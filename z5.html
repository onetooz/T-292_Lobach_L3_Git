<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Загрузка данных JSONPlaceholder</title>
</head>
<body>
  <h1>Данные JSONPlaceholder</h1>
  <button id="loadBtn">Загрузить данные</button>

  <h2>Posts</h2>
  <ul id="postsList"></ul>

  <h2>Comments</h2>
  <ul id="commentsList"></ul>

  <h2>Users</h2>
  <ul id="usersList"></ul>

  <h2>Todos</h2>
  <ul id="todosList"></ul>

  <script>
    document.getElementById('loadBtn').addEventListener('click', async () => {
      try {
        const postsRes = await fetch('https://jsonplaceholder.typicode.com/todos/1/posts');
        const postsData = await postsRes.json();
        const postsSorted = postsData.sort((a, b) => b.title.length - a.title.length);
        const postsList = document.getElementById('postsList');
        postsList.innerHTML = '';
        postsSorted.slice(0, 3).forEach(post => {
          const li = document.createElement('li');
          li.textContent = post.title;
          postsList.appendChild(li);
        });

        const commentsRes = await fetch('https://jsonplaceholder.typicode.com/todos/1/comments');
        const commentsData = await commentsRes.json();
        const commentsSorted = commentsData.sort((a, b) => a.name.localeCompare(b.name));
        const commentsList = document.getElementById('commentsList');
        commentsList.innerHTML = '';
        commentsSorted.slice(0, 3).forEach(comment => {
          const li = document.createElement('li');
          li.textContent = comment.name + ': ' + comment.body;
          commentsList.appendChild(li);
        });

        const usersRes = await fetch('https://jsonplaceholder.typicode.com/todos/1/users');
        const usersData = await usersRes.json();
        const usersTrimmed = usersData.map(u => ({
          id: u.id,
          name: u.name,
          username: u.username,
          email: u.email,
          phone: u.phone
        }));
        const usersList = document.getElementById('usersList');
        usersList.innerHTML = '';
        usersTrimmed.forEach(user => {
          const li = document.createElement('li');
          li.textContent = `${user.name} (${user.username}) — ${user.email}, ${user.phone}`;
          usersList.appendChild(li);
        });

        const todosRes = await fetch('https://jsonplaceholder.typicode.com/todos/1/todos');
        const todosData = await todosRes.json();
        const todosFiltered = todosData.filter(todo => !todo.completed);
        const todosList = document.getElementById('todosList');
        todosList.innerHTML = '';
        todosFiltered.slice(0, 5).forEach(todo => {
          const li = document.createElement('li');
          li.textContent = todo.title;
          todosList.appendChild(li);
        });

      } catch (err) {
        console.error(err);
        alert("Ошибка при загрузке данных");
      }
    });
  </script>
</body>
</html>